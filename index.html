<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>서버 제조사별 모니터링 선택기</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color: #0f172a;
        font-family: "Space Grotesk", "Segoe UI", system-ui, -apple-system, sans-serif;
        background: radial-gradient(circle at 20% 20%, #d5f5f0 0, transparent 28%),
          radial-gradient(circle at 80% 10%, #dfe7ff 0, transparent 25%),
          linear-gradient(135deg, #f6f8fb 0%, #eef2f7 50%, #e9edf3 100%);
        line-height: 1.5;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
      }

      .nav {
        position: sticky;
        top: 0;
        z-index: 10;
        backdrop-filter: blur(8px);
        background: rgba(255, 255, 255, 0.75);
        border-bottom: 1px solid #d7deec;
      }

      .nav-inner {
        max-width: 1100px;
        margin: 0 auto;
        padding: 10px 20px;
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: center;
      }

      .nav a,
      .dropbtn {
        text-decoration: none;
        color: #0f172a;
        font-weight: 700;
        padding: 6px 10px;
        border-radius: 10px;
        transition: background 120ms ease, color 120ms ease, border-color 120ms ease;
        border: 1px solid transparent;
        background: transparent;
        cursor: pointer;
      }

      .nav a:hover,
      .dropbtn:hover {
        background: #0f766e;
        color: #fff;
        border-color: #0f766e;
      }

      .dropdown {
        position: relative;
      }

      .dropdown-menu {
        display: none;
        position: absolute;
        top: 110%;
        left: 0;
        background: #ffffff;
        border: 1px solid #d7deec;
        border-radius: 12px;
        box-shadow: 0 10px 40px rgba(15, 23, 42, 0.12);
        padding: 8px;
        min-width: 180px;
        flex-direction: column;
        gap: 4px;
      }

      .dropdown-menu a {
        display: block;
        padding: 8px 10px;
        border-radius: 8px;
        border: 1px solid transparent;
      }

      .dropdown-menu a:hover {
        background: #e2f3f0;
        border-color: #0f766e;
      }

      .dropdown:hover .dropdown-menu {
        display: flex;
      }

      .page {
        max-width: 1100px;
        margin: 0 auto;
        padding: 48px 20px 64px;
        display: flex;
        flex-direction: column;
        gap: 28px;
      }

      header {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      h1 {
        margin: 0;
        font-size: 32px;
        letter-spacing: -0.02em;
      }

      .lede {
        margin: 0;
        color: #475569;
        max-width: 720px;
      }

      .grid {
        display: grid;
        grid-template-columns: 1.1fr 1fr;
        gap: 20px;
        align-items: stretch;
      }

      .card {
        background: #ffffff;
        border: 1px solid #d6deec;
        border-radius: 16px;
        padding: 18px 18px;
        box-shadow: 0 16px 50px rgba(15, 23, 42, 0.08);
        display: flex;
        flex-direction: column;
        gap: 14px;
      }

      label {
        font-weight: 600;
        display: block;
        margin-bottom: 6px;
      }

      select,
      input {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid #cbd5e1;
        background: #f8fafc;
        font-size: 15px;
      }

      .hint {
        color: #64748b;
        font-size: 13px;
        margin-top: 4px;
      }

      .pill {
        align-self: flex-start;
        padding: 6px 10px;
        border-radius: 999px;
        background: #ecfeff;
        color: #0f766e;
        font-weight: 700;
        font-size: 12px;
      }

      .method-title {
        margin: 0;
        font-size: 22px;
      }

      .muted {
        color: #475569;
        margin: 0;
      }

      .list {
        padding-left: 18px;
        margin: 0;
        color: #0f172a;
      }

      .code-block {
        background: #0f172a;
        color: #e2e8f0;
        border-radius: 12px;
        padding: 12px;
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
        font-size: 13px;
        line-height: 1.5;
        overflow-x: auto;
      }

      .row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .badge {
        padding: 4px 10px;
        border-radius: 10px;
        background: #eef2ff;
        color: #312e81;
        font-weight: 700;
        font-size: 12px;
      }

      @media (max-width: 900px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <script>
      (() => {
        const ok = localStorage.getItem("hwmon_logged_in") === "1";
        if (!ok) window.location.href = "/ui/login.html";
      })();
    </script>
    <nav class="nav">
      <div class="nav-inner">
        <a href="/ui/index.html">Home</a>
        <div class="dropdown">
          <button class="dropbtn">제조사별</button>
          <div class="dropdown-menu">
            <a href="/ui/ilo.html">HPE iLO</a>
            <a href="/ui/idrac.html">Dell iDRAC</a>
            <a href="/ui/imm.html">Lenovo/IMM</a>
            <a href="/ui/supermicro.html">Supermicro</a>
            <a href="/ui/other.html">기타/ETC</a>
          </div>
        </div>
        <a href="/ui/servers.html">Server Info</a>
        <a href="/ui/logs.html">Logs</a>
        <a href="/ui/analysis.html">Analysis</a>
      </div>
    </nav>
    <div class="page">
      <header>
        <div class="pill">수집 전략</div>
        <h1>서버 제조사에 맞춰 모니터링 방식 선택</h1>
        <p class="lede">
          사용자가 제조사/BMC 정보를 입력하면 권장 수집 방식(표준 Redfish, IPMI, 벤더 확장)을 안내합니다.
          이 페이지는 설계 가이드이며, 나중에 API 연동으로 자동 설정할 수 있습니다.
        </p>
      </header>

      <div class="card">
        <h2>로그 분석/예측 알고리즘 개요</h2>
        <p class="muted">
          TEMS는 BMC 로그를 정규화(timestamp/host/service/severity/message)한 뒤 메시지를 템플릿화 또는 TF-IDF로 벡터화하고, 최근 윈도우의 심각도 비율·서비스별 카운트·메시지 임베딩을 특징으로 만듭니다.
          IsolationForest 기반 이상 탐지로 윈도우 이상도를 계산해 0~1 리스크 스코어로 정규화하며, 메시지 키워드/템플릿을 전력(PSU/전압), 냉각(FAN), 스토리지(SMART), 네트워크(timeout/latency) 등으로 매핑해 원인 후보를 집계합니다.
          ALL 모드에서는 ILO/IDRAC/IMM/슈퍼마이크로/기타 로그를 합쳐 분석하고, 최근 로그를 Evidence로 함께 표시합니다. 실제 환경에서는 Redfish/IPMI 원시 로그를 투입해 Drain3 같은 템플릿화로 노이즈를 줄이고,
          라벨이 있으면 분류/시퀀스 모델(LSTM/Transformer)로 확장하거나, 무라벨이면 One-Class SVM/AutoEncoder 등으로 교체해 성능을 높일 수 있습니다. 현재는 모의 데이터와 단순 키워드 매핑+IsolationForest 흐름을 사용하며,
          실데이터 연동 시 스코어/원인/증거가 실시간으로 갱신됩니다.
        </p>
      </div>

      <div class="grid">
        <div class="card">
          <div>
            <label for="vendor">제조사 / BMC</label>
            <select id="vendor">
              <option value="hpe">HPE (iLO)</option>
              <option value="dell">Dell (iDRAC)</option>
              <option value="lenovo">Lenovo/IBM (XCC/IMM)</option>
              <option value="supermicro">Supermicro (BMC/IPMI)</option>
              <option value="other">기타/확인 필요</option>
            </select>
            <p class="hint">Redfish 지원 여부와 세대를 기준으로 자동 추천합니다.</p>
          </div>
          <div>
            <label for="bmc">BMC IP (선택)</label>
            <input id="bmc" type="text" placeholder="예: 172.30.1.241" />
          </div>
          <div>
            <label for="user">BMC 계정 (선택)</label>
            <input id="user" type="text" placeholder="예: admin" />
          </div>
        </div>

        <div class="card" id="result-card">
          <div class="row">
            <span class="badge" id="recommended">Redfish 우선</span>
            <span class="badge" id="fallback">IPMI 대체</span>
          </div>
          <h2 class="method-title" id="method-title">HPE iLO: Redfish + IML</h2>
          <p class="muted" id="method-desc">
            최신 iLO는 Redfish를 기본으로 지원합니다. 이벤트/센서/전력 정보는 Redfish로 수집하고, 구형은 IPMI SEL로 대체하세요.
          </p>
          <div>
            <p class="muted"><strong>Redfish 엔드포인트</strong></p>
            <div class="code-block" id="redfish-snippet"></div>
          </div>
          <div>
            <p class="muted"><strong>IPMI 대안</strong></p>
            <div class="code-block" id="ipmi-snippet"></div>
          </div>
          <p class="muted" id="notes">
            셀프사인 인증서인 경우 `-k`(인증서 무시) 옵션으로 테스트하고, 운영 시는 인증서 신뢰 구성을 권장합니다.
          </p>
        </div>
      </div>
    </div>

    <script>
      const profiles = {
        hpe: {
          title: "HPE iLO: Redfish + IML",
          desc:
            "최신 iLO는 Redfish를 지원합니다. 이벤트 로그(IML)와 센서는 Redfish, 구형은 IPMI SEL로 대체하세요.",
          redfish: (ip) =>
            `curl -k -u <user>:<pass> https://${ip || "<bmc-ip>"}:443/redfish/v1/Systems/1/LogServices/IEL/Entries`,
          ipmi: (ip, user) =>
            `ipmitool -I lanplus -H ${ip || "<bmc-ip>"} -U ${user || "<user>"} sel elist`,
          recommended: "Redfish 우선",
          fallback: "IPMI 대체",
          notes: "IML/전력/열 등 상세 정보는 Redfish가 더 풍부합니다. IPMI는 구형 호환용입니다.",
        },
        dell: {
          title: "Dell iDRAC: Redfish + Lifecycle Log",
          desc:
            "iDRAC은 Redfish와 RACADM를 지원합니다. Lifecycle Log/센서/전력은 Redfish로 수집하고, 구형은 IPMI SEL로 대체하세요.",
          redfish: (ip) =>
            `curl -k -u <user>:<pass> https://${ip || "<bmc-ip>"}:443/redfish/v1/Systems/System.Embedded.1/LogServices/Lclog/Entries`,
          ipmi: (ip, user) =>
            `ipmitool -I lanplus -H ${ip || "<bmc-ip>"} -U ${user || "<user>"} sel elist`,
          recommended: "Redfish 우선",
          fallback: "IPMI 대체",
          notes: "펌웨어/인벤토리까지 필요하면 Redfish를 사용하고, 긴급 시 RACADM도 백업 옵션입니다.",
        },
        lenovo: {
          title: "Lenovo/IBM XCC/IMM: Redfish 가능 시 우선",
          desc:
            "XCC(신형)는 Redfish 지원, IMM(구형)은 IPMI 중심입니다. 가능하면 Redfish, 불가 시 IPMI SEL/센서로 수집하세요.",
          redfish: (ip) =>
            `curl -k -u <user>:<pass> https://${ip || "<bmc-ip>"}:443/redfish/v1/Systems/1/LogServices/SEL/Entries`,
          ipmi: (ip, user) =>
            `ipmitool -I lanplus -H ${ip || "<bmc-ip>"} -U ${user || "<user>"} sensor`,
          recommended: "Redfish 우선",
          fallback: "IPMI 대체",
          notes: "IMM 세대는 Redfish가 없을 수 있으니 IPMI를 기본으로, 가능하면 XCC로 업그레이드 검토.",
        },
        supermicro: {
          title: "Supermicro BMC: IPMI 기본, Redfish 지원 시 사용",
          desc:
            "기본은 IPMI SEL/센서 수집입니다. 신형 펌웨어는 Redfish를 지원하므로 가능하면 Redfish로 전환하세요.",
          redfish: (ip) =>
            `curl -k -u <user>:<pass> https://${ip || "<bmc-ip>"}:443/redfish/v1/Systems/1/LogServices/SEL/Entries`,
          ipmi: (ip, user) =>
            `ipmitool -I lanplus -H ${ip || "<bmc-ip>"} -U ${user || "<user>"} sel elist`,
          recommended: "IPMI 기본",
          fallback: "Redfish(지원 시)",
          notes: "구형은 IPMI만 가능하며, Redfish 지원 모델은 TLS 설정을 확인하세요.",
        },
        other: {
          title: "기타/확인 필요: Redfish 테스트 후 IPMI",
          desc:
            "우선 Redfish 지원 여부를 확인하고, 불가하면 IPMI SEL/센서로 수집하세요. BMC 매뉴얼에서 API 지원 현황을 확인해야 합니다.",
          redfish: (ip) =>
            `curl -k -u <user>:<pass> https://${ip || "<bmc-ip>"}:443/redfish/v1/Systems/1/LogServices/SEL/Entries`,
          ipmi: (ip, user) =>
            `ipmitool -I lanplus -H ${ip || "<bmc-ip>"} -U ${user || "<user>"} sel elist`,
          recommended: "Redfish 우선",
          fallback: "IPMI 대체",
          notes: "BMC 세대/펌웨어에 따라 지원이 다릅니다. 테스트 후 스키마 매핑을 확정하세요.",
        },
      };

      const vendorEl = document.getElementById("vendor");
      const bmcEl = document.getElementById("bmc");
      const userEl = document.getElementById("user");
      const methodTitle = document.getElementById("method-title");
      const methodDesc = document.getElementById("method-desc");
      const redfishSnippet = document.getElementById("redfish-snippet");
      const ipmiSnippet = document.getElementById("ipmi-snippet");
      const notes = document.getElementById("notes");
      const recommended = document.getElementById("recommended");
      const fallback = document.getElementById("fallback");

      function render() {
        const key = vendorEl.value;
        const profile = profiles[key];
        const ip = bmcEl.value.trim();
        const user = userEl.value.trim();

        methodTitle.textContent = profile.title;
        methodDesc.textContent = profile.desc;
        redfishSnippet.textContent = profile.redfish(ip);
        ipmiSnippet.textContent = profile.ipmi(ip, user);
        notes.textContent = profile.notes;
        recommended.textContent = profile.recommended;
        fallback.textContent = profile.fallback;
      }

      vendorEl.addEventListener("change", render);
      bmcEl.addEventListener("input", render);
      userEl.addEventListener("input", render);
      render();
    </script>
  </body>
</html>
